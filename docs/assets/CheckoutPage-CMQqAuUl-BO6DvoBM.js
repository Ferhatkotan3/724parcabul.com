import{M as w,G as v,j as N,x as e,o as m}from"./index-KYK8dnUx.js";function k(){const h=w(),{cart:c,clearCart:j,user:o,isDarkMode:t}=v(),[p,g]=N.useState(!1),[r,x]=N.useState({firstName:o?.full_name?.split(" ")[0]||"",lastName:o?.full_name?.split(" ")[1]||"",email:o?.email||"",phone:"",address:"",city:"",district:"",postalCode:"",cardNumber:"",expiryDate:"",cvv:"",cardName:"",notes:""}),u=c.reduce((l,i)=>l+i.price*i.quantity,0),b=u>500?0:29.99,y=u+b,s=l=>{const{name:i,value:d}=l.target;if(i==="cardNumber"){const a=d.replace(/\s/g,"").replace(/(.{4})/g,"$1 ").trim();a.length<=19&&x(n=>({...n,[i]:a}));return}if(i==="expiryDate"){const a=d.replace(/\D/g,"").replace(/(.{2})/,"$1/");a.length<=5&&x(n=>({...n,[i]:a}));return}if(i==="cvv"){const a=d.replace(/\D/g,"");a.length<=3&&x(n=>({...n,[i]:a}));return}x(a=>({...a,[i]:d}))},f=async l=>{l.preventDefault(),g(!0);try{if(["firstName","lastName","email","phone","address","city","district","postalCode","cardNumber","expiryDate","cvv","cardName"].filter(a=>!r[a]).length>0){m.error("Lütfen tüm zorunlu alanları doldurun"),g(!1);return}if(r.cardNumber.replace(/\s/g,"").length!==16){m.error("Geçerli bir kart numarası girin"),g(!1);return}await new Promise(a=>setTimeout(a,2e3));const i={id:Date.now().toString(),userId:o?.id||"guest",items:c.map(a=>({id:a.id,name:a.name,price:a.price,quantity:a.quantity,image:a.image})),total:y,status:"preparing",shippingAddress:{firstName:r.firstName,lastName:r.lastName,address:r.address,city:r.city,district:r.district,postalCode:r.postalCode},paymentMethod:"credit_card",createdAt:new Date().toISOString(),trackingNumber:`724PB${Date.now().toString().slice(-8)}`,notes:r.notes},d=JSON.parse(localStorage.getItem("orders")||"[]");d.push(i),localStorage.setItem("orders",JSON.stringify(d)),j(),m.success("Siparişiniz başarıyla oluşturuldu!"),h(`/order-success/${i.id}`)}catch{m.error("Sipariş oluşturulurken hata oluştu")}finally{g(!1)}};return c.length===0?(h("/cart"),null):e.jsx("div",{className:`min-h-screen ${t?"bg-gray-900":"bg-gray-50"} py-8`,children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:`text-2xl font-bold mb-8 ${t?"text-white":"text-gray-900"}`,children:"Sipariş Tamamla"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("form",{onSubmit:f,className:"space-y-8",children:[e.jsxs("div",{className:`p-6 rounded-lg ${t?"bg-gray-800":"bg-white"} shadow-sm`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-4 ${t?"text-white":"text-gray-900"}`,children:"Kişisel Bilgiler"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Ad *"}),e.jsx("input",{type:"text",name:"firstName",value:r.firstName,onChange:s,required:!0,className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Soyad *"}),e.jsx("input",{type:"text",name:"lastName",value:r.lastName,onChange:s,required:!0,className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"E-posta *"}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:s,required:!0,className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Telefon *"}),e.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:s,required:!0,placeholder:"0555 123 45 67",className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]})]})]}),e.jsxs("div",{className:`p-6 rounded-lg ${t?"bg-gray-800":"bg-white"} shadow-sm`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-4 ${t?"text-white":"text-gray-900"}`,children:"Teslimat Adresi"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Adres *"}),e.jsx("textarea",{name:"address",value:r.address,onChange:s,required:!0,rows:3,className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"İl *"}),e.jsx("input",{type:"text",name:"city",value:r.city,onChange:s,required:!0,className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"İlçe *"}),e.jsx("input",{type:"text",name:"district",value:r.district,onChange:s,required:!0,className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Posta Kodu *"}),e.jsx("input",{type:"text",name:"postalCode",value:r.postalCode,onChange:s,required:!0,className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]})]})]})]}),e.jsxs("div",{className:`p-6 rounded-lg ${t?"bg-gray-800":"bg-white"} shadow-sm`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-4 ${t?"text-white":"text-gray-900"}`,children:"Ödeme Bilgileri"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Kart Üzerindeki İsim *"}),e.jsx("input",{type:"text",name:"cardName",value:r.cardName,onChange:s,required:!0,className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Kart Numarası *"}),e.jsx("input",{type:"text",name:"cardNumber",value:r.cardNumber,onChange:s,required:!0,placeholder:"1234 5678 9012 3456",className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"Son Kullanma Tarihi *"}),e.jsx("input",{type:"text",name:"expiryDate",value:r.expiryDate,onChange:s,required:!0,placeholder:"MM/YY",className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t?"text-gray-300":"text-gray-700"}`,children:"CVV *"}),e.jsx("input",{type:"text",name:"cvv",value:r.cvv,onChange:s,required:!0,placeholder:"123",className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]})]})]})]}),e.jsxs("div",{className:`p-6 rounded-lg ${t?"bg-gray-800":"bg-white"} shadow-sm`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-4 ${t?"text-white":"text-gray-900"}`,children:"Sipariş Notu (Opsiyonel)"}),e.jsx("textarea",{name:"notes",value:r.notes,onChange:s,rows:3,placeholder:"Siparişinizle ilgili özel notlarınız...",className:`w-full px-3 py-2 border rounded-lg text-sm ${t?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:ring-2 focus:ring-blue-500 focus:border-transparent`})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:`p-6 rounded-lg ${t?"bg-gray-800":"bg-white"} shadow-sm sticky top-4`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-4 ${t?"text-white":"text-gray-900"}`,children:"Sipariş Özeti"}),e.jsx("div",{className:"space-y-3 mb-4",children:c.map(l=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm font-medium ${t?"text-white":"text-gray-900"}`,children:l.name}),e.jsxs("p",{className:`text-xs ${t?"text-gray-400":"text-gray-500"}`,children:[l.quantity," adet"]})]}),e.jsxs("p",{className:`text-sm font-medium ${t?"text-white":"text-gray-900"}`,children:[(l.price*l.quantity).toFixed(2),"₺"]})]},l.id))}),e.jsxs("div",{className:`border-t pt-4 space-y-2 ${t?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`text-sm ${t?"text-gray-300":"text-gray-600"}`,children:"Ara Toplam"}),e.jsxs("span",{className:`text-sm ${t?"text-white":"text-gray-900"}`,children:[u.toFixed(2),"₺"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`text-sm ${t?"text-gray-300":"text-gray-600"}`,children:"Kargo"}),e.jsx("span",{className:`text-sm ${t?"text-white":"text-gray-900"}`,children:b===0?"Ücretsiz":`${b.toFixed(2)}₺`})]}),e.jsxs("div",{className:`flex justify-between font-semibold text-lg border-t pt-2 ${t?"border-gray-700 text-white":"border-gray-200 text-gray-900"}`,children:[e.jsx("span",{children:"Toplam"}),e.jsxs("span",{children:[y.toFixed(2),"₺"]})]})]}),e.jsx("button",{type:"submit",form:"checkout-form",onClick:f,disabled:p,className:"w-full mt-6 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer whitespace-nowrap font-medium",children:p?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"İşleniyor..."]}):`${y.toFixed(2)}₺ Öde`}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-xs text-gray-500",children:[e.jsx("i",{className:"ri-shield-check-line"}),e.jsx("span",{children:"Güvenli ödeme"})]})})]})})]})]})})}export{k as default};
